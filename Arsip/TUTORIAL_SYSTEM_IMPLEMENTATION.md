# ðŸ“š Tutorial System Implementation Log

**Date:** 13 Januari 2026
**Status:** âœ… Completed
**Developer:** Antigravity

---

## ðŸŽ¯ Overview
Implementation of a complete Tutorial Content Management System (CMS) allowing admins to create, edit, and manage rich text tutorials which are then displayed on the User Portal.

## ðŸ—ï¸ Architecture

### 1. Database Schema (PostgreSQL)
Six new tables were created to support the hierarchical tutorial data structure:

```sql
-- Main Tutorials Table
CREATE TABLE tutorials (
    id SERIAL PRIMARY KEY,
    slug VARCHAR(255) UNIQUE NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    duration VARCHAR(50),      -- e.g., "5 menit"
    type VARCHAR(50),          -- 'video' or 'article'
    category VARCHAR(50),      -- e.g., 'Dasar', 'Advanced'
    icon VARCHAR(50),          -- Lucide icon name
    cover_image TEXT,
    video_url TEXT,
    is_published BOOLEAN DEFAULT false,
    order_index INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Content Sections
CREATE TABLE tutorial_sections (
    id SERIAL PRIMARY KEY,
    tutorial_id INTEGER REFERENCES tutorials(id) ON DELETE CASCADE,
    order_index INTEGER NOT NULL,
    title VARCHAR(255) NOT NULL,
    content TEXT,              -- HTML Content from TipTap
    image_url TEXT,            -- Optional section image
    image_caption VARCHAR(255)
);

-- Supporting Tables
CREATE TABLE tutorial_tips (...);
CREATE TABLE tutorial_warnings (...);
CREATE TABLE tutorial_faqs (...);
CREATE TABLE tutorial_related (...);
```

### 2. Admin Portal (Port 3001)

#### Features
- **CRUD Management**: `/tutorials` page for full lifecycle management.
- **Rich Text Editor**: Integrated **TipTap** editor replacing standard textareas.
  - **Toolbar**: Bold, Italic, Headings (H1-H3), Lists (Bullet/Ordered), Links, Blockquote.
  - **Images**: Drag-and-drop Image Uploader component.
- **Image Management**:
  - API endpoint: `POST /api/uploads/tutorials`
  - Validates file type (Initial image support) and size (max 5MB).
  - Storage: `public/uploads/tutorials`.
- **SSR Handling**: Fixed Next.js hydration mismatch using `immediatelyRender: false`.

#### Components
- `components/tutorials-management-page.tsx`: Main CRUD interface.
- `components/ui/rich-text-editor.tsx`: TipTap wrapper with toolbar.
- `components/ui/image-uploader.tsx`: Drag-and-drop uploader.

### 3. User Portal (Port 3000)

#### Features
- **Dynamic Routing**: `/tutorial/[slug]` fetches data from API.
- **HTML Rendering**: Uses `@tailwindcss/typography` (`prose` class) to render rich text safely.
- **Image Proxying**: Helper function `resolveImageUrl` redirects relative image paths (`/uploads/...`) to the Admin Portal server (`http://localhost:3001`) to fix broken images.
- **Responsive Design**: Mobile-friendly layout with sticky Table of Contents.
- **Dark Mode Compatible**: Text colors optimized for readability (`text-gray-900` headings).

#### Components
- `app/tutorial/[slug]/page.tsx`: optimized rendering component.
- `RenderContent`: Smart component handling both legacy Markdown and new HTML content.

---

## ðŸ”„ API Endpoints

### Admin API
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/tutorials` | List all tutorials with filtering |
| POST | `/api/tutorials` | Create new tutorial |
| GET | `/api/tutorials/[id]` | Get detailed tutorial data |
| PUT | `/api/tutorials/[id]` | Update tutorial & nested data |
| DELETE | `/api/tutorials/[id]` | Soft delete/Hard delete tutorial |
| POST | `/api/uploads/tutorials` | Upload image file |

### User API
| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/api/tutorials` | Get published tutorials |
| GET | `/api/tutorials/[slug]` | Get tutorial by slug |

---

## ðŸ“ Usage Guide

### Creating a Tutorial
1. Login to **Admin Portal**.
2. Navigate to **Configuration > Tutorials**.
3. Click **"Tambah Tutorial"**.
4. Fill in Basic Info (Title, Slug, Category).
5. Go to **Sections** tab:
   - Add sections.
   - Write content using the **Rich Text Editor**.
   - Upload illustrations using the **Image Uploader**.
6. Save and Publish.

### Uploading Images
- Click the upload area in the Section form to select a file.
- Or drag-and-drop an image.
- Image will be uploaded to local storage and linked automatically.

---
**Generated by Antigravity**
